type Query {
	viewer: User
	node(id: ID!): Node
	searchMessages(query: String!, mailboxId: ID, limit: Int, offset: Int): [Message!]!
}

type Mutation {
	assignTargetMailbox(input: AssignTargetMailboxInput!): Contact
	markThreadSeen(id: ID!): Thread
}

input AssignTargetMailboxInput {
	contactID: ID!
	targetMailboxType: MailboxType!
}

type User implements Node {
	id: ID!
	username: String!
	name: String!
	avatar: String!
	mailbox(type: MailboxType!): Mailbox
}

type Mailbox implements Node {
	id: ID!
	type: MailboxType!
	name: String!
	unseenThreadsCount: Int!
	threads(first: Int, after: String, filter: ThreadsFilter): ThreadsConnection!
	assignedContactsCount: Int!
	contacts(first: Int, after: String): ContactConnection!
}

enum MailboxType {
	screener
	important
	news
	transactional
	trash
}

input ThreadsFilter {
	unseen: Boolean!
}

type ThreadsConnection implements Connection {
	pageInfo: PageInfo!
	edges: [ThreadEdge!]!
}

type ThreadEdge implements Edge {
	cursor: String
	node: Thread!
}

type Thread implements Node {
	id: ID!
	from: Contact!
	unseenMessagesCount: Int!
	title: String
	snippet: String
	lastMessageAt: DateTime!
	messages: [Message!]!
}

type Message implements Node {
	id: ID!
	threadId: ID!
	from: Contact!
	unseen: Boolean!
	recievedAt: DateTime!
	subject: String
	to: [String!]
	cc: [String!]
	replyTo: [String!]
	snippet: String
	bodyText: String
	bodyHTML: String
	attachments: [Attachment!]!
}

type ContactConnection implements Connection {
	pageInfo: PageInfo!
	edges: [ContactEdge!]!
}

type ContactEdge implements Edge {
	cursor: String
	node: Contact!
}

type Contact implements Node {
	id: ID!
	address: String!
	name: String!
	avatar: String!
	targetMailbox: Mailbox!
	messages: [Message!]!
}

type Attachment implements Node {
	id: ID!
	fileName: String
	mimeType: String
	contentId: String
	url: String
}

interface Connection {
	pageInfo: PageInfo!
	edges: [Edge!]!
}

type PageInfo {
	startCursor: String
	endCursor: String
	hasNextPage: Boolean
	hasPreviousPage: Boolean
}

interface Edge {
	cursor: String
	node: Node!
}

interface Node {
	id: ID!
}

scalar DateTime
scalar URL

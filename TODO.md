- [ ] `Email/set` mailboxIds patch currently behaves like a full replacement and ignores `false` flags (`apps/backend/src/lib/jmap/method-handlers/email-set.ts:1154` and `:1497`). Update the logic so mailboxIds booleans add/remove memberships incrementally per RFC 8621, and allow pure removal patches unless they would leave the Email without any mailbox.
- [ ] When removing a mailbox, `removeMailboxMemberships` simply deletes memberships even if that leaves affected Emails with zero mailboxes (`apps/backend/src/lib/jmap/method-handlers/mailbox-set.ts:151`). Ensure each Email still has at least one mailbox afterward (e.g., move to Inbox/Trash or reject destroy).
- [ ] `Mailbox/set` never checks for duplicate names among siblings (`apps/backend/src/lib/jmap/method-handlers/mailbox-set.ts:255`), allowing multiple child mailboxes with the same case-insensitive name under one parent. Add uniqueness validation for both create and update operations as required by RFC 8621.
